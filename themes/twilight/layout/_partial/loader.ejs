<% if (theme.preloader.enable) { %>
  <div id='loader'>
    <div class="loader-backdrop"></div>
    <div class="loader-content">
      <% if (theme.preloader.icon) { %>
        <img class="loader-icon <%- theme.preloader.rotate ? 'rotate' : '' %>" src="<%- url_for(theme.preloader.icon, {relative: false})%>" alt="loading" />
      <% } else { %>
        <div class="loader-spinner <%- theme.preloader.rotate ? 'rotate' : '' %>"></div>
      <% } %>
      <% var preloaderText = theme.preloader.text; %>
      <% if (typeof preloaderText !== 'string') { %>
        <% preloaderText = preloaderText[post.lang]; %>
      <% } %>
      <div class="loading-word"><%= preloaderText %></div>
    </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>
<% } %>
<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.3s ease; position: fixed; top: 20px; right: 20px; z-index: 9999; color: #d63384; background: rgba(255, 245, 247, 0.95); padding: 12px 20px; border-radius: 12px; border: 1px solid rgba(255, 182, 193, 0.5); box-shadow: 0 4px 12px rgba(236, 64, 122, 0.15); display: flex; align-items: center; gap: 8px; font-weight: 500;">
</div>
<div id="heatmap-tooltip"></div>

<% if (theme.service_worker.enable) { %>
  <div class="notification-wrapper">
    <h1><%= __("service_worker.title") %></h1>
    <p><%= __("service_worker.content") %></p>
    <div class="notification-btn">
      <button id="notification-update-btn"><%= __("service_worker.confirm") %></button>
      <button id="notification-close-btn"><%= __("service_worker.cancel") %></button>
    </div>
  </div>
<% } %>
